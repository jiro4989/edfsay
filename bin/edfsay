#!/bin/bash

readonly THIS_DIR="$(cd "$(dirname "${BASH_SOURCE[0]:-${(%):-%N}}")"; pwd)"
SCRIPT_NAME=edfsay
readonly VERSION=v1.0.0

main() {
  local cmd=$1
  shift
  case "$cmd" in
    chat|commlog)
      : 何もしない
      ;;

    '-h'|'--help')
      usage
      return 0
      ;;

    '-v'|'--version')
      echo $VERSION
      return 0
      ;;

    '--edf')
      # TODO
      return 0
      ;;

    *)
      echo 不正
      return 1
      ;;
  esac

  local script_name="$SCRIPT_NAME"
  export SCRIPT_NAME="$SCRIPT_NAME $cmd"
  "$THIS_DIR/$script_name.$cmd" ${1+"$@"}
}

usage() {
  cat << EOS
$SCRIPT_NAME はEDFがセリフを発する。

Usage:
    $SCRIPT_NAME [options] [messages...]

Options:
    -h, --help            このヘルプを出力する
    -v, --version         バージョン情報を出力する
        --edf             EDF! EDF!!
    -t, --type <type>     実際のEDF隊員の発言を出力する [type | commlog]
    -n, --linecount       何行出力するか [default: 1]
                          typeオプションと合わせて使う。
    -g, --genre <genre>   EDF隊員の発言を分類で絞り込む
                          typeオプションと合わせて使う。
                          分類は[yes | no | TODO]
        --sd              echo-sdを使う
EOS
}

main ${1+"$@"}
